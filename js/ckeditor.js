window.vBulletin=window.vBulletin||{};window.vBulletin.phrase=window.vBulletin.phrase||{};window.vBulletin.phrase.precache=window.vBulletin.phrase.precache||[];window.vBulletin.phrase.precache=$.merge(window.vBulletin.phrase.precache,["wrap_x_tags"]);window.vBulletin.options=window.vBulletin.options||{};window.vBulletin.options.precache=window.vBulletin.options.precache||[];window.vBulletin.options.precache=$.merge(window.vBulletin.options.precache,[]);vBulletin.ckeditor=vBulletin.ckeditor||{};if(jQuery.type(window.vBulletin.smilieInfo)==="undefined"){var initSmiley={name:"",dash:""}}else{var initSmiley={name:"Smiley",dash:"-"}}if(typeof (pageData.ckeditorCss)!="undefined"){CKEDITOR.config.contentsCss=pageData.ckeditorCss}CKEDITOR.config.toolbar_vBulletinFull=[["RemoveFormat","-","PasteText","PasteFromWord","-","Font","FontSize","-","TextColor","-",initSmiley.name,initSmiley.dash,"Undo","Redo"],["Bold","Italic","Underline"],["JustifyLeft","JustifyCenter","JustifyRight"],["NumberedList","BulletedList","Outdent","Indent"],["Link","Email","Unlink","Image"],["Quote"],["Code","Html","Php"],["Table","TableProperties","DeleteTable","-","InsertRowBefore","InsertRowAfter","DeleteRow","-","InsertColumnBefore","InsertColumnAfter","DeleteColumn","-","Subscript","Superscript","HorizontalRule"]];CKEDITOR.config.toolbar_vBulletinMinimal=[["RemoveFormat"],["Bold","Italic","Underline"]];CKEDITOR.config.toolbar_vBulletinBare=[];var CK2BB={Font:"font",FontSize:"size",TextColor:"color",Bold:"b",Italic:"i",Underline:"u",Subscript:"sub",Superscript:"sup",HorizontalRule:"hr",Table:"table",TableProperties:"table",DeleteTable:"table",InsertRowBefore:"table",InsertRowAfter:"table",DeleteRow:"table",InsertColumnBefore:"table",InsertColumnAfter:"table",DeleteColumn:"table",JustifyLeft:"left",JustifyCenter:"center",JustifyRight:"right",NumberedList:"list",BulletedList:"list",Outdent:"indent",Indent:"indent",Link:"url",Email:"email",Unlink:"url",Quote:"quote",Code:"code",Html:"html",Php:"php"};if(jQuery.type(window.vBulletin.customBbcode)!=="undefined"){var items=[];for(var bbcodetag in window.vBulletin.customBbcode){if(!bbcodetag){continue}var bbcode=window.vBulletin.customBbcode[bbcodetag];items.push(bbcode.title)}if(items.length>0){CKEDITOR.config.toolbar_vBulletinFull[8]=items}}CKEDITOR.config.baseHref=pageData.baseurl+"/";CKEDITOR.config.smiley_path=pageData.baseurl_core+"/";CKEDITOR.config.enterMode=CKEDITOR.ENTER_BR;CKEDITOR.config.entities=false;CKEDITOR.config.height="100px";CKEDITOR.config.width="100%";vBulletin.ckeditor.config={toolbar:"vBulletinMinimal",customConfig:"",toolbarCanCollapse:false,resize_dir:"vertical",removePlugins:"about,contextmenu,elementspath,link,smiley",extraPlugins:"vblink,vbsmiley,vbwrapbuttons",pluginPath:pageData.baseurl+"/js/ckeplugins/",tabIndex:1,disableNativeSpellChecker:false,filebrowserImageUploadUrl:pageData.baseurl+"/uploader/CKEditorInsertImage"};var plugins=vBulletin.ckeditor.config.extraPlugins.split(",");for(var i=0;i<plugins.length;i++){console.log(plugins[i]);try{if(!CKEDITOR.plugins.get(plugins[i])){console.log("Ckeditor: Plugin Loaded: "+pageData.baseurl+"/js/ckeplugins/"+plugins[i]+"/plugin.js");CKEDITOR.plugins.addExternal(plugins[i],vBulletin.ckeditor.config.pluginPath+plugins[i]+"/","plugin.js")}}catch(e){}}vBulletin.ckeditor.editorDefinitions={"ckeditor-bare":{toolbar:"vBulletinBare",callback:function(B,A){}},"ckeditor-bare-video":{toolbar:"vBulletinBare",callback:function(B,A){}},"ckeditor-bare-poll":{toolbar:"vBulletinBare",callback:function(B,A){}},"ckeditor-bare-poll-edit":{toolbar:"vBulletinBare",callback:function(B,A){}},"ckeditor-bare-link":{toolbar:"vBulletinBare",callback:function(B,A){}},"ckeditor-bare-edit":{toolbar:"vBulletinBare",callback:function(B,A){}},"ckeditor-bare-video-edit":{toolbar:"vBulletinBare",callback:function(B,A){}},"ckeditor-bare-link-edit":{toolbar:"vBulletinBare",callback:function(B,A){}},"ckeditor-bare-gallery":{toolbar:"vBulletinBare",callback:function(B,A){}},"ckeditor-bare-gallery-edit":{toolbar:"vBulletinBare",callback:function(B,A){}},"ckeditor-bare-mediagallery":{toolbar:"vBulletinBare",callback:function(B,A){}},"ckeditor-bare-mediagallery-edit":{toolbar:"vBulletinBare",callback:function(B,A){}},"ckeditor-advanced":{toolbar:"vBulletinFull",callback:function(B,A){}},"ckeditor-signature":{toolbar:"vBulletinFull",callback:function(B,A){}}};vBulletin.ckeditor.editorDefinitions["ckeditor-bare-mediavideo"]=vBulletin.ckeditor.editorDefinitions["ckeditor-bare-video"];vBulletin.ckeditor.editorDefinitions["ckeditor-bare-mediavideo-edit"]=vBulletin.ckeditor.editorDefinitions["ckeditor-bare-video-edit"];vBulletin.ckeditor.instances={};vBulletin.ckeditor.initAutoTitle=function(D,B){var A=$("#"+D).closest("form");var F=A.find('input[name="title"]').add('textarea[name="title"]',A).add('input[name="gallery_title"]',A).first();if(F.length==1){var E="";var C=function(){var G=$.trim($("<div>"+B.getData()+"</div>").text()).substr(0,50);if(F.val()==""||F.val()==E){F.val(G);E=G}};B.on("key",function(){window.setTimeout(C,0)})}};vBulletin.ckeditor.initFocusTitle=function(D,C){var B=$("#"+D).closest("form");var A=B.find('input[name="title"]').add('textarea[name="title"]',B).add('input[name="gallery_title"]',B).first();if(A.length==1){A.focus();console.log("Ckeditor: Focus on title for editor: {0}".format(D))}else{C.focus();console.log("Ckeditor: Focus on editor for editor: {0}".format(D))}};vBulletin.ckeditor.maintainContent=function(B,A){console.log("Ckeditor: maintainContent for "+B);var C=function(E){var D=$("#"+E).closest("form");return D.find(".title-field")};$("#"+B).closest(".content-entry-box").find('textarea[name="text"]').each(function(){var D=$(this).attr("id");if(D==B){return true}if(vBulletin.ckeditor.editorExists(D)){var H=vBulletin.ckeditor.getEditor(D).getData();vBulletin.ckeditor.destroyEditor(D);$("#"+D).val("");A.insertHtml(H);var J=C(D);if(J.length){C(B).val(J.val());J.val("")}var G=$("#"+D).closest("form").find("select.prefixid");var I=$("#"+B).closest("form").find("select.prefixid");if(I.length&&G.length){I.selectBox("value",G.selectBox("value"));G.selectBox("value","")}var E=$("#"+D).closest("form").find("input[name=fbpublish]");var F=$("#"+B).closest("form").find("input[name=fbpublish]");if(E.length){F.attr("checked",E.attr("checked"));E.attr("checked",false)}return false}})};vBulletin.ckeditor.convertToAdvancedEditor=function(A){vBulletin.ckeditor.toggleAdvancedAndBasicEditor(A,"advanced")};vBulletin.ckeditor.convertToBasicEditor=function(A){vBulletin.ckeditor.toggleAdvancedAndBasicEditor(A,"basic")};vBulletin.ckeditor.toggleAdvancedAndBasicEditor=function(F,E){var D=($("#"+F).data("toolbar-toggle-state")||"untoggled")=="toggled";var A=$("#cke_"+F+" .cke_wrapper .cke_toolbar").length>0;window.console.log("Ckeditor: Starting toggleAdvancedAndBasicEditor\n\teditorId: "+F+"\n\tforceToggle: "+((typeof E=="undefined")?"Undefined":E)+"\n\thasToolbar: "+A+"\n\tisToggled: "+D);if(typeof E!="undefined"){if((E=="advanced"&&A)||(E=="basic"&&!A)){return }}if(vBulletin.ckeditor.editorExists(F)){var B=vBulletin.ckeditor.getEditor(F).getData();vBulletin.ckeditor.destroyEditor(F);$("#"+F).val("")}else{var B=$("#"+F).val();$("#"+F).val("")}if(A){$("#"+F).addClass("ckeditor-no-toolbar")}else{$("#"+F).removeClass("ckeditor-no-toolbar")}$("#"+F).data("toolbar-toggle-state",(D?"untoggled":"toggled"));var C={toolbar:(A?"vBulletinBare":"vBulletinFull"),callback:function(H,G){G.insertHtml(B);window.console.log("Ckeditor: Finished toggleAdvancedAndBasicEditor")}};vBulletin.ckeditor.initEditor(F,{editorDefinition:C})};vBulletin.ckeditor.doInitEditor=function(B,J,A){if(CKEDITOR.env.mobile&&!CKEDITOR.env.isCompatible){console.log("Ckeditor: Not supported on this mobile device");vBulletin.ckeditor.hideLoadingDialog(B);return }console.log("Ckeditor: Initializing editor: {0}".format(B));A=A||false;var C=$("#"+B);C.trigger("beforeInit",[B]);if(!A&&typeof vBulletin.ckeditor.editorDefinitions[B]=="undefined"){console.log("The editor ({0}) is not defined. Please create the editor definition in vBulletin.ckeditor.editorDefinitions near the top of ckeditor.js.".format(B));return }if(vBulletin.ckeditor.editorExists(B)){console.log("The editor ({0}) already exists. Destroy to allow recreation.".format(B));vBulletin.ckeditor.destroyEditor(B)}if(C.is(":visible")){C.val(" ")}A=A||vBulletin.ckeditor.editorDefinitions[B];vBulletin.ckeditor.config.toolbar=A.toolbar;var F=C.data("disable-features");if(F){if(F=="all"){vBulletin.ckeditor.config.toolbar=CKEDITOR.config.toolbar_vBulletinBare}else{F=F.split(",");var E=CKEDITOR.config["toolbar_"+vBulletin.ckeditor.config.toolbar];var I,G,D,H;for(G=0;G<E.length;G++){for(D=0;D<E[G].length;D++){I=E[G][D];if(I.length==0||I=="-"||!CK2BB[I]){continue}if(jQuery.inArray(CK2BB[I],F)>=0){delete CKEDITOR.config["toolbar_"+vBulletin.ckeditor.config.toolbar][G][D]}}}}}vBulletin.ckeditor.initPlaceholder=function(M){var O=$(M.element).attr("placeholder");if(O){console.log("Ckeditor: initializing placeholder...");function K(P){P=$.trim($("<div />").append(P).find("br").remove().end().html()).replace(/&nbsp;|\s|\n|\t/g,"");P=$("<div />").append(P).find("p:empty").remove().end().html();return !P}function N(Q){if(M.focusManager.hasFocus||(Q&&Q.name=="blur"&&CKEDITOR.dialog._.currentTop)){return }var P=M.document?M.document.getBody():null;if(!P){return }if(K(P.getHtml())){P.addClass("placeholder");P.setHtml(O)}}function L(Q){var P=M.document?M.document.getBody():null;if(!P||!P.hasClass("placeholder")){return }P.removeClass("placeholder");P.setHtml("")}M.on("getData",function(Q){var P=Q.editor.document?Q.editor.document.getBody():null;if(P&&P.hasClass("placeholder")){Q.data.dataValue=""}});M.on("blur",N);M.on("mode",N);M.on("focus",L);M.on("beforeModeUnload",L);N()}};C.ckeditor(function(){var K=$("#cke_"+B+" .cke_wrapper .cke_toolbar").length>0;if(K){$("#"+B).removeClass("ckeditor-no-toolbar")}vBulletin.ckeditor.hideLoadingDialog(B);A.callback(B,this);vBulletin.ckeditor.instances[B]=this;try{this.setReadOnly(false)}catch(L){this.setReadOnly(false)}vBulletin.ckeditor.maintainContent(B,this);vBulletin.ckeditor.initPlaceholder(this);vBulletin.ckeditor.initFocusTitle(B,this);console.log("Ckeditor: Editor initialized: {0}".format(B));if(typeof J=="function"){return J.apply(this,[B])}},vBulletin.ckeditor.config);if(C.closest("form").length>0){C.closest("form").attr("ck-editorid",B);console.log('Ckeditor: Added editorId "'+B+'" to form')}C.trigger("afterInit",[B])};vBulletin.ckeditor.editorExists=function(A){return(typeof vBulletin.ckeditor.instances[A]!="undefined"&&vBulletin.ckeditor.instances[A])};vBulletin.ckeditor.getEditor=function(A){return vBulletin.ckeditor.editorExists(A)?vBulletin.ckeditor.instances[A]:null};vBulletin.ckeditor.destroyEditor=function(A){console.log("Ckeditor: Destroying editor: {0}".format(A));if(vBulletin.ckeditor.editorExists(A)){try{vBulletin.ckeditor.getEditor(A).destroy()}catch(B){}vBulletin.ckeditor.instances[A]=null;$("#"+A).addClass("ckeditor-no-toolbar");return true}else{console.warn("Ckeditor: Not destroyed, because editor {0} does not exist.".format(A))}return false};CKEDITOR.on("instanceReady",function(B){var A=B.editor;if(CKEDITOR.env.ie){try{document.execCommand("AutoUrlDetect",false,false)}catch(D){}}var C=$("#cke_contents_"+A.name).children().filter(function(){return this.tagName=="IFRAME"?true:false});if(parseInt(A.config.width)<310){C.hide();C.show()}if("ontouchstart" in document.documentElement){C.get(0).contentWindow.scrollTo(0,10)}});