/**
*	@name							Elastic
*	@descripton						Elastic is jQuery plugin that grow and shrink your textareas automatically
*	@version						1.6.11
*	@requires						jQuery 1.2.6+
*
*	@author							Jan Jarfalk
*	@author-email					jan.jarfalk@unwrongest.com
*	@author-website					http://www.unwrongest.com
*
*	@licence						MIT License - http://www.opensource.org/licenses/mit-license.php
*/
/*
*  Modified for vBulletin:
*  - Replace twin DOM node instead of adding a new one for every elastic textarea
*  - Added namespace to events bound by the plugin to the textarea to allow us to programmatically trigger events specific to this plugin
*  - Added checking for CSS box-sizing in determining the actual height and width of the textarea
*/
(function(e){jQuery.fn.extend({elastic:function(){var t=["paddingTop","paddingRight","paddingBottom","paddingLeft","fontSize","lineHeight","fontFamily","width","fontWeight","border-top-width","border-right-width","border-bottom-width","border-left-width","borderTopStyle","borderTopColor","borderRightStyle","borderRightColor","borderBottomStyle","borderBottomColor","borderLeftStyle","borderLeftColor"];return this.each(function(){function a(){var e=n().width;if(i.width()!==e){i.css({width:e+"px"});l(true)}}function f(e,t){var i=parseInt(e,10);if(n().height!==i){r.css({height:i+"px",overflow:t})}}function l(e){var t=r.val().replace(/&/g,"&").replace(/ {2}/g," ").replace(/<|>/g,">").replace(/\n/g,"<br />");var s=i.html().replace(/<br>/ig,"<br />");if(e||t+" "!==s){i.html(t+" ");if(Math.abs(i.height()+lineHeight-n().height)>3){var o=i.height()+lineHeight;if(o>=maxheight){f(maxheight,"auto")}else if(o<=minheight){f(minheight,"hidden")}else{f(o,"hidden")}}}}if(this.type!=="textarea"){return false}var n=function(){return s=="border-box"?{height:r.outerHeight(),width:r.outerWidth()}:s=="padding-box"?{height:r.innerHeight(),width:r.innerWidth()}:{height:r.height(),width:r.width()}};var r=jQuery(this),i=jQuery("<div />").css({position:"absolute",display:"none","word-wrap":"break-word","white-space":"pre-wrap"}).addClass("elastic-twin-div"),s=r.css("box-sizing")||r.css("-moz-box-sizing")||r.css("-webkit-box-sizing")||"content-box";lineHeight=parseInt(r.css("line-height"),10)||parseInt(r.css("font-size"),"10"),minheight=n().height||lineHeight*3,maxheight=parseInt(r.css("max-height"),10)||Number.MAX_VALUE,goalheight=0;if(maxheight<0){maxheight=Number.MAX_VALUE}var o=e("> .elastic-twin-div",r.parent());if(o.length==1){o.replaceWith(i)}else{i.appendTo(r.parent())}var u=t.length;while(u--){i.css(t[u].toString(),r.css(t[u].toString()))}r.css({overflow:"hidden"});r.bind("keyup.elastic change.elastic cut.elastic paste.elastic",function(){l()});e(window).bind("resize.elastic",a);r.bind("resize.elastic focus.elastic",a);r.bind("update.elastic",l);r.bind("blur.elastic",function(){if(i.height()<maxheight){if(i.height()>minheight){r.height(i.height())}else{r.height(minheight)}}});r.bind("input.elastic paste.elastic",function(e){setTimeout(l,250)});l()})}})})(jQuery)