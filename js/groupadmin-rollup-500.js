window.vBulletin=window.vBulletin||{};window.vBulletin.phrase=window.vBulletin.phrase||{};window.vBulletin.phrase.precache=window.vBulletin.phrase.precache||[];window.vBulletin.phrase.precache=$.merge(window.vBulletin.phrase.precache,["add_moderator_gforumdisplay","confirm_delete_group_channel","delete_a_group_channel","delete_group","edit_group_icon","error_adding_moderator","error_deleting_group","group_icon","group_title_exists","groups","manage_subscribers","transfer_group_ownership","unexpected_error"]);var sgIconUploadDlg=false;var sgIconEditDlg=false;(function(A){var B=[".blogadmin-widget",".summary-widget"];if(!vBulletin.pageHasSelectors(B)){return false}A(document).ready(function(){A(".btnGroupReset").off("click").on("click",function(K){if(A(".groupIcon .groupIconUrl").val()){A(".groupIcon .groupIconImg").attr("src",A(".groupIcon .groupIconUrl").val());A(".groupIcon .groupFileDataId").val(A(".groupIcon .initFiledataid").val())}else{A(".groupIcon .groupIconImg").addClass("hide");A(".groupIcon .groupFileDataId").val("")}return true});var G=new vBulletin_Autocomplete(A(".moderator_input"),{apiClass:"user",maxItems:1,containerClass:"group-moderator-autocomplete"});A(document).off("click",".add_moderator").on("click",".add_moderator",function(K){K.stopPropagation();$moderatorForm=A(this).closest("form");$channelid=$moderatorForm.find(':input[name="nodeid"]').val();$recipient=G.getElements();$recipient=$recipient[0]["value"];A("body").css("cursor","wait");A.ajax({url:vBulletin.getAjaxBaseurl()+"/ajax/api/node/requestChannel",type:"post",data:{channelid:$channelid,recipientname:$recipient,requestType:"sg_moderator_to"},dataType:"json",success:function(L){if(L&&!L.errors){location.reload()}else{if(A.isArray(L.errors)&&L.errors.length>0){openAlertDialog({title:vBulletin.phrase.get("add_moderator_gforumdisplay"),message:vBulletin.phrase.get("error_x",L.errors[0][0]),iconType:"error"})}}},complete:function(){A("body").css("cursor","default")},error:function(){openAlertDialog({title:vBulletin.phrase.get("add_moderator_gforumdisplay"),message:vBulletin.phrase.get("error_adding_moderator"),iconType:"error"})}})});A(document).off("click",".btnRemoveContributor").on("click",".btnRemoveContributor",function(K){K.stopPropagation();$moderatorForm=A(this).closest("form");$channelid=$moderatorForm.find(':input[name="nodeid"]').val();$userid=A(this).attr("userid");$usergroupid=A(this).attr("usergroupid");A("body").css("cursor","wait");A.ajax({url:vBulletin.getAjaxBaseurl()+"/ajax/api/user/unsetGroupInTopic",type:"post",data:{userid:$userid,nodeids:$channelid,usergroupid:$usergroupid},dataType:"json",success:function(L){if(L&&!L.errors){location.reload()}else{if(A.isArray(L.errors)&&L.errors.length>0){openAlertDialog({title:vBulletin.phrase.get("add_moderator_gforumdisplay"),message:vBulletin.phrase.get("error_x",L.errors[0][0]),iconType:"error"})}}},complete:function(){A("body").css("cursor","default")},error:function(){openAlertDialog({title:vBulletin.phrase.get("add_moderator_gforumdisplay"),message:vBulletin.phrase.get("error_adding_folder"),iconType:"error"})}})});A(document).off("click",".btnTransferOwnership").on("click",".btnTransferOwnership",function(N){var L=A(this).closest("form");var K=L.find(':input[name="nodeid"]').val();var M=openConfirmDialog({title:vBulletin.phrase.get("transfer_group_ownership"),message:"Loading...",width:500,dialogClass:"transfer-ownership-dialog loading",buttonLabel:{yesLabel:vBulletin.phrase.get("send_request"),noLabel:vBulletin.phrase.get("cancel")},onClickYes:function(){if(A(".transfer-ownership-dialog .transfer_owner_select:visible").length>0){$user=A(".transfer-ownership-dialog .transfer_owner_select").val()}else{$user=A('.transfer-ownership-dialog :input[name="transfer_owner_autocomplete"]').val()}if($user.length==0){return false}A.ajax({url:vBulletin.getAjaxBaseurl()+"/ajax/api/node/requestChannel",type:"post",data:{channelid:K,recipientname:$user,requestType:"owner_to"},dataType:"json",success:function(O){if(O&&!O.errors){location.reload()}else{if(A.isArray(O.errors)&&O.errors.length>0){openAlertDialog({title:vBulletin.phrase.get("transfer_group_ownership"),message:vBulletin.phrase.get("error_x",O.errors[0][0]),iconType:"error"})}}},complete:function(){A("body").css("cursor","default")},error:function(){openAlertDialog({title:vBulletin.phrase.get("transfer_group_ownership"),message:vBulletin.phrase.get("error_adding_folder"),iconType:"error"})}})}});A.ajax({url:vBulletin.getAjaxBaseurl()+"/ajax/render/sgadmin_transferownership",data:({nodeid:K}),type:"POST",dataType:"json",success:function(O){console.log("/ajax/render/sgadmin_transferownership");if(O&&!O.errors){A(".transfer-ownership-dialog").removeClass("loading");A(".dialog-content .message",M).html(O).find("[placeholder]").placeholder();M.dialog("option","position","center");transferOwnerAutocomplete=new vBulletin_Autocomplete(A(".transfer_owner_autocomplete"),{apiClass:"user",maxItems:1});A(".transfer_ownership_tabs").tabs()}else{console.log("/ajax/render/sgadmin_transferownership successful, but response was not valid");openAlertDialog({title:vBulletin.phrase.get("error"),message:vBulletin.phrase.get("invalid_server_response_please_try_again"),iconType:"error",onAfterClose:function(){M.dialog("close")}})}},error:function(Q,P,O){console.log("/ajax/render/sgadmin_transferownership failed, error: "+O);openAlertDialog({title:vBulletin.phrase.get("move_posts"),message:"Error loading move form. (Error code {0})<br /><br />Please try again.".format(Q.status),iconType:"error",onAfterClose:function(){M.dialog("close")}})}})});var J=new vBulletin_Autocomplete(A(".moderator_members_input"),{apiClass:"user",containerClass:"group-moderator-autocomplete"});A(".groupadmin-widget .groupAdminRight .manage_moderators_row .moderators_right #select-all").off("change").on("change",function(){var M=A(this);var L=M.is(":checked");var K=M.closest(".moderators_right").find(".subscribers-list-container");if(L){K.find(":input[type=checkbox]").attr("checked",true)}else{K.find(":input[type=checkbox]").attr("checked",false)}});A(".groupRemoveSubscriber").off("click").on("click",removeSubscriber);A(".groupRemoveMember").off("click").on("click",removeMember);A(".groupAdminSubscriberPaging .right-arrow, .groupAdminSubscriberPaging .left-arrow").off("click").on("click",subscriberChangePage);A(".groupAdminSubscriberPaging .right-arrow ").removeClass("disabled");A(".groupAdminSubscriberPaging .pagenav .textbox").off("change").on("change",subscriberChangePage);A("#btnGroupDelete").off("click").on("click",function(){var K=A(this).closest("form");var L=K.find(':input[name="nodeid"]').val();openConfirmDialog({title:vBulletin.phrase.get("delete_a_group_channel"),message:vBulletin.phrase.get("confirm_delete_group_channel"),iconType:"warning",onClickYes:function(){A.ajax({url:vBulletin.getAjaxBaseurl()+"/ajax/api/content_channel/delete",type:"post",data:{nodeid:L},dataType:"json",success:function(M){if(M&&!M.errors){window.location.href=pageData.baseurl+"/social-groups";return false}else{if(A.isArray(M.errors)&&M.errors.length>0){openAlertDialog({title:vBulletin.phrase.get("delete_group"),message:vBulletin.phrase.get("error_x",M.errors[0][0]),iconType:"error"})}}},complete:function(){A("body").css("cursor","default")},error:function(){openAlertDialog({title:vBulletin.phrase.get("delete_group"),message:vBulletin.phrase.get("error_deleting_group"),iconType:"error"})}});return false},onClickNo:function(){}});return false});(function(){try{var K=A("#upload-button-placeholder");var L=A(".groupicon-upload-form");K.height(L.height());L.css({position:"absolute"}).offset(K.offset()).removeClass("hide")}catch(M){}});var C=A.cookie(pageData.cookie_prefix+"group_title");if(C!=null){A('.groupAdminForm :input[name="title"]').val(C.replace(/\+/g," "));A.cookie(pageData.cookie_prefix+"group_title",null,{path:pageData.baseurl_path})}var I=A.cookie(pageData.cookie_prefix+"group_description");if(I!=null){A('.groupAdminForm :input[name="description"]').val(I.replace(/\+/g," "));A.cookie(pageData.cookie_prefix+"group_description",null,{path:pageData.baseurl_path})}var E=A.cookie(pageData.cookie_prefix+"groupadmin_error");if(E!=null){openAlertDialog({title:vBulletin.phrase.get("groups"),message:vBulletin.phrase.get(E),iconType:"error"});A.cookie(pageData.cookie_prefix+"groupadmin_error",null,{path:pageData.baseurl_path})}if(A(".groupAdmin-stats-table").length>0){var H=A(".groupAdmin-stats-table").data("nodeid");A(document).off("click",".showDaily").on("click",".showDaily",function(K){renderStats(H,"daily",1,".groupAdminRight")});A(document).off("click",".showMonthly").on("click",".showMonthly",function(K){renderStats(H,"monthly",1,".groupAdminRight")});vBulletin.pagination({context:".groupAdminRight",onPageChanged:function(K,L){renderStats(H,"daily",K,".groupAdminRight")}})}A(".editGroupIcon").off("click").on("click",function(K){if(!sgIconEditDlg){sgIconEditDlg=A(K.target).closest(".groupSummaryContainer").find(".sgIconUploader").dialog({width:600,autoOpen:false,modal:true,title:vBulletin.phrase.get("edit_group_icon"),dialogClass:"dialog-container"})}A(sgIconEditDlg).dialog("open");$Rx.Modal.init();return false});A(".sgAddIcon").off("click").on("click",function(K){if(!sgIconUploadDlg){sgIconUploadDlg=A(K.target).closest(".blogAdminRight").find(".sgIconUploader").dialog({width:600,autoOpen:false,modal:true,title:vBulletin.phrase.get("edit_group_icon"),dialogClass:"dialog-container"})}A(sgIconUploadDlg).dialog("open");$Rx.Modal.init();return false});A(".btnSGIconCancel").off("click").on("click",function(K){A(K.target).closest(".sgIconUploader").dialog("close")});A(".btnSGIconUrlSubmit").off("click").on("click",uploadIconFromUrl);A(".sgRadioIconFile").off("click").on("click",function(K){A(K.target).closest(".sgIconUploader ").find(".sgIconFileChooser").removeClass("hide");A(K.target).closest(".sgIconUploader ").find(".sgIconUrlInput ").addClass("hide")});A(".sgRadioIconUrl").off("click").on("click",function(K){A(K.target).closest(".sgIconUploader ").find(".sgIconFileChooser").addClass("hide");A(K.target).closest(".sgIconUploader ").find(".sgIconUrlInput ").removeClass("hide")});var F=A(".groupIconImg");var D=vBulletin.getAjaxBaseurl()+"/uploader/"+(F.length>0?"uploadSGIcon":"upload_file");A(".uploadSgIcon").fileupload({formData:function(K){return[{name:"nodeid",value:K.data("nodeid")},{name:"uploadFrom",value:K.data("content-type")}]},url:D,add:function(L,K){K.submit()},done:function(L,K){if(K){if(K.result.errors){if(typeof (K.result.errors[0])=="undefined"){openAlertDialog({title:vBulletin.phrase.get("group_icon"),message:vBulletin.phrase.get(K.result.errors),iconType:"error"})}else{openAlertDialog({title:vBulletin.phrase.get("group_icon"),message:vBulletin.phrase.get(K.result.errors[0]),iconType:"error"})}}else{if(K.result.imageUrl){if(F.length>0){A(".groupIconImg").attr("src",K.result.thumbUrl);A(sgIconEditDlg).dialog("close")}else{A(".sgIconPreview").html('<img src="'+K.result.thumbUrl+'" alt="">');A(".sGIconfiledataid").val(K.result.filedataid);A(sgIconUploadDlg).dialog("close")}}else{openAlertDialog({title:vBulletin.phrase.get("group_icon"),message:vBulletin.phrase.get("unable_to_upload_file"),iconType:"error"})}}}else{openAlertDialog({title:vBulletin.phrase.get("group_icon"),message:vBulletin.phrase.get("invalid_server_response_please_try_again"),iconType:"error"})}},fail:function(N,L){var M=vBulletin.phrase.get("error_uploading_image");var K="error";if(L&&L.files.length>0){switch(L.files[0].error){case"acceptFileTypes":M=vBulletin.phrase.get("invalid_image_allowed_filetypes_are");K="warning";break;case"maxFileSize":M=vBulletin.phrase.get("image_exceeded_max_file_size","100 KB");K="warning";break}}openAlertDialog({title:vBulletin.phrase.get("upload"),message:M,iconType:K,onAfterClose:function(){$editProfilePhotoDlg.find(".fileText").val("");$editProfilePhotoDlg.find(".browse-option").focus()}})}});A(".sgAdminForm").submit(checkSgContentValid)})})(jQuery);removeMember=function(B){var A=$(B.target).closest(".manage_moderators_row");userid=$(B.target).attr("data-userid");groupid=$(B.target).attr("data-groupid");nodeid=$(B.target).attr("data-nodeid");if(userid&&(userid>0)&&groupid&&(groupid>0)&&nodeid&&(nodeid>0)){$.ajax({url:vBulletin.getAjaxBaseurl()+"/ajax/api/user/unsetgroupintopic",type:"post",data:{userid:userid,nodeids:nodeid,usergroupid:groupid},dataType:"json",success:function(C){if(C&&!C.errors){A.remove()}else{if($.isArray(C.errors)&&C.errors.length>0){openAlertDialog({title:vBulletin.phrase.get("manage_subscribers"),message:vBulletin.phrase.get("error_x",C.errors[0][0]),iconType:"error"})}}},complete:function(){$("body").css("cursor","default")},error:function(){openAlertDialog({title:vBulletin.phrase.get("manage_subscribers"),message:vBulletin.phrase.get("error_adding_folder"),iconType:"error"})}})}};removeSubscriber=function(B){var A=$(B.target).closest(".manage_moderators_row");userid=$(B.target).attr("data-userid");nodeid=$(B.target).attr("data-nodeid");if(userid&&(userid>0)&&nodeid&&(nodeid>0)){$.ajax({url:vBulletin.getAjaxBaseurl()+"/ajax/api/follow/delete",type:"post",data:{follower:nodeid,type:"follow_channel",userid:userid},dataType:"json",success:function(C){if(C&&!C.errors){A.remove()}else{if($.isArray(C.errors)&&C.errors.length>0){openAlertDialog({title:vBulletin.phrase.get("manage_subscribers"),message:vBulletin.phrase.get("error_x",C.errors[0][0]),iconType:"error"})}}},complete:function(){$("body").css("cursor","default")},error:function(){openAlertDialog({title:vBulletin.phrase.get("manage_subscribers"),message:vBulletin.phrase.get("error_adding_folder"),iconType:"error"})}})}};var pageno=1;subscriberChangePage=function(B){pageCount=parseInt($(B.target).closest(".groupAdminSubscriberPaging").attr("data-pagecount"));if($(B.target).hasClass("left-arrow")||$(B.target).parent().hasClass("left-arrow")){var A=pageno-1;if(A<1){$(B.target).addClass("disabled");return }}else{if($(B.target).hasClass("right-arrow")||$(B.target).parent().hasClass("right-arrow")){var A=pageno+1;if(A>pageCount){$(B.target).addClass("disabled");return }}else{if($(B.target).hasClass("textbox")){var A=parseInt($(B.target).val());if(isNaN(A)||(A>pageCount)||(A<1)){$(B.target).val(this.pageno);return }}else{return }}}url=vBulletin.getAjaxBaseurl()+"/ajax/render/sgadmin_subscriberlist?pageno="+A+"&nodeid="+$(B.target).closest(".groupAdminEditPage").attr("data-nodeid");$.ajax({url:url,type:"post",dataType:"json",success:function(C){$(B.target).closest(".groupAdminEditPage").find(".subscriberList").html(C);if(A>=pageCount){$(B.target).closest(".groupAdminEditPage").find(".right-arrow").addClass("disabled")}else{$(B.target).closest(".groupAdminEditPage").find(".right-arrow").removeClass("disabled")}if(A<=1){$(B.target).closest(".groupAdminEditPage").find(".left-arrow").addClass("disabled")}else{$(B.target).closest(".groupAdminEditPage").find(".left-arrow").removeClass("disabled")}$(B.target).closest(".groupAdminEditPage").find(".pagenav .textbox").val(A);pageno=A;$(".groupRemoveSubscriber").off("click").on("click",removeSubscriber)}})};function renderStats(B,A,C,D){vBulletin.AJAX({url:vBulletin.getAjaxBaseurl()+"/ajax/render/widget_groupstats?nodeid="+B+"&interval="+A+"&page="+C,success:function(E){$(D).html(E)}})}uploadIconFromUrl=function(C){var B=$(".groupIconImg");var A=vBulletin.getAjaxBaseurl()+"/uploader/"+(B.length>0?"uploadSGIcon":"url");vBulletin.AJAX({url:A,error_phrase:"upload_errors",data:{nodeid:$(C.target).closest(".sgicon-upload-form").data("nodeid"),url:$(C.target).parent(".sgIconUrlInput").find("#imgUrl").val(),urlupload:$(C.target).parent(".sgIconUrlInput").find("#imgUrl").val()},success:function(D){if(B.length>0){$(".groupIconImg").attr("src",D.imageUrl);$(sgIconEditDlg).dialog("close")}else{$(".sgIconPreview").html('<img src="'+D.imageUrl+'" alt="">');$(".sGIconfiledataid").val(D.filedataid);$(sgIconUploadDlg).dialog("close")}}})};checkSgContentValid=function(B){category=$(B.target).find(".sgCategory");if(parseInt(category.val())<=0){openAlertDialog({title:vBulletin.phrase.get("groups"),message:vBulletin.phrase.get("please_select_category"),iconType:"error"});return false}title=$(B.target).find(".sGtitle");if(title.length&&title.val().length<4){openAlertDialog({title:vBulletin.phrase.get("groups"),message:vBulletin.phrase.get("please_enter_title"),iconType:"error"});return false}var A=$(B.target).find(".blogAdminNodeId").val();if(A>0){$.ajax({url:vBulletin.getAjaxBaseurl()+"/ajax/api/user/hasPermissions",data:{nodeid:A,group:"forumpermissions",permission:"canconfigchannel",},type:"POST",dataType:"json",async:false,success:function(C){if(!C.errors){if(C===false){B.preventDefault();openAlertDialog({title:vBulletin.phrase.get("social_groups"),message:vBulletin.phrase.get("cannot_edit_group_info"),iconType:"warning"});return false}}else{openAlertDialog({title:vBulletin.phrase.get("social_groups"),message:vBulletin.phrase.get(C.errors[0][0]),iconType:"warning"});return false}}})}};;

window.vBulletin=window.vBulletin||{};window.vBulletin.phrase=window.vBulletin.phrase||{};window.vBulletin.phrase.precache=window.vBulletin.phrase.precache||[];window.vBulletin.phrase.precache=$.merge(window.vBulletin.phrase.precache,["group_subscribers_list","group_subscribers","unable_to_contact_server_please_try_again"]);(function(A){var B=[".summary-widget"];if(!vBulletin.pageHasSelectors(B)){return false}vBulletin.group=vBulletin.group||{};vBulletin.group.initSeeAllSubscribers=function(){var C=A("#groupSubscribersSeeAll");if(C.length>0){C.click(function(D){vBulletin.group.showSubscribers(A(this).attr("data-node-id"));D.stopPropagation();return false})}};vBulletin.group.showSubscribers=function(E,D,C){if(!vBulletin.group.groupSubscribersAllOverlay){vBulletin.group.groupSubscribersAllOverlay=A("#groupSubscribersAll").dialog({title:vBulletin.phrase.get("group_subscribers_list"),autoOpen:false,modal:true,resizable:false,closeOnEscape:false,showCloseButton:false,width:450,dialogClass:"dialog-container dialog-box group-subscribers-dialog"});vBulletin.pagination({context:"#groupSubscribersAll",onPageChanged:function(F,G){vBulletin.group.showSubscribers(E,F)}});A(document).off("click",".group-subscribers-close").on("click",".group-subscribers-close",function(){vBulletin.group.groupSubscribersAllOverlay.dialog("close")});A(document).off("click","#groupSubscribersAll .action_button").on("click","#groupSubscribersAll .action_button",function(){if(!A(this).hasClass("subscribepending_button")){var F=A(this);var H=parseInt(F.attr("data-userid"));var G="";if(F.hasClass("subscribe_button")){G="add"}else{if(F.hasClass("unsubscribe_button")){G="delete"}}if((typeof (H)=="number")&&G){A.ajax({url:vBulletin.getAjaxBaseurl()+"/profile/follow_button?do="+G+"&follower="+H+"&type=follow_members",dataType:"json",success:function(J){if(J==1||J==2){if(G=="add"){var I=(J==1)?"subscribed":"subscribepending";var K=(J==1)?"following":"following_pending";F.removeClass("subscribe_button special").addClass(I+"_button secondary").text(vBulletin.phrase.get(K))}else{if(G=="delete"){F.removeClass("subscribed_button unsubscribe_button special").addClass("subscribe_button secondary").text(vBulletin.phrase.get("follow"))}}}else{if(J.errors){openAlertDialog({title:vBulletin.phrase.get("profile_guser"),message:vBulletin.phrase.get("error_x",J.errors[0][0]),iconType:"error"})}}},error:function(){openAlertDialog({title:vBulletin.phrase.get("profile_guser"),message:vBulletin.phrase.get("unable_to_contact_server_please_try_again"),iconType:"error"})}})}}})}if(!D){D=1}if(!C){C=10}A.ajax({url:vBulletin.getAjaxBaseurl()+"/ajax/render/subscribers_list",type:"POST",data:{nodeid:E,page:D,perpage:C},dataType:"json",success:function(F){if(F&&F.errors){openAlertDialog({title:vBulletin.phrase.get("group_subscribers"),message:vBulletin.phrase.get(F.errors[0]),iconType:"error"})}else{A(".group-subscribers-content",vBulletin.group.groupSubscribersAllOverlay).html(F)}},error:function(){openAlertDialog({title:vBulletin.phrase.get("group_subscribers"),message:vBulletin.phrase.get("unable_to_contact_server_please_try_again"),iconType:"error"})}});vBulletin.group.groupSubscribersAllOverlay.dialog("open")};A(document).ready(function(){vBulletin.group.initSeeAllSubscribers();A(".summary-widget .adminmenu_container .admin-mainmenu .mainmenu").off("mouseenter mouseleave").on("mouseenter",function(C){var D=A(this);hoverTimer=setTimeout(function(){D.removeClass("pos-top").addClass("hover").closest(".admin-mainmenu").find(".mainmenu .submenu").hide().css("top","");var I={},F=A(".submenu",D).show();if(!vBulletin.isScrolledIntoView(F,I)){var H=A(document).height()-A(window).height(),G=A(document).scrollTop(),E=Math.abs(I.bottom);if(E<=(H-G)){A("html,body").animate({scrollTop:"+="+(G+E)},"slow")}else{F.css("top",-(F.height()+1)).parent().addClass("pos-top");if(!vBulletin.isScrolledIntoView(F,I)){A("html,body").animate({scrollTop:"-="+Math.abs(I.top)},"slow")}}}},200)}).on("mouseleave",function(C){clearTimeout(hoverTimer);A(".submenu",this).hide();A(this).removeClass("hover")})})})(jQuery);;

